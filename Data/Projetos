'''Projetos

Cadastrar, listar, buscar, atualizar, remover.

Regras: nome único por projeto; datas válidas (início ≤ fim).'''
from datetime import date #Isso aqui é para colocar as datas de iniciação e término dos projetos depois
def verifyTXT():
    while True:
        try:
            x = int(input())
            if(x<0 or x>5):
                print("O número não corresponde com as opções. Tente novamente")
                continue
        except ValueError:
            print("Você não digitou um número. Tente novamente")
            continue
        break
    return x

def check(a):
    return a.upper() in projetos

def obterdatas():
    lista1 = [1, 3, 5, 7, 8, 10, 12]
    lista2 = [4, 6, 9, 11]
    while True:
        try:
            ano = int(input("Digite o ano de início do projeto: "))
        except ValueError:
            print("O ano só contém números. Tente novamente")
            continue
        break

    while True:
        try:
            mes = int(input("Digite o mês de início do projeto (1-12): "))
            if mes < 1 or mes > 12:
                print("O número do mês deve ser de 1-12. Tente novamente")
                continue
        except ValueError:
            print("O mês só contém números. Tente novamente")
            continue
        break

    while True:
        if mes in lista1:
            try:
                dia = int(input("Digite o dia de início do projeto (1-31): "))
                if dia < 1 or dia > 31:
                    print("O número do dia deve ser de 1-31. Tente novamente")
                    continue
            except ValueError:
                print("O dia só contém números. Tente novamente")
                continue
        elif mes in lista2:
            try:
                dia = int(input("Digite o dia de início do projeto (1-30): "))
                if dia < 1 or dia > 30:
                    print("O número do dia deve ser de 1-30. Tente novamente")
                    continue
            except ValueError:
                print("O dia só contém números. Tente novamente")
                continue
        elif mes == 2 and ano % 4 == 0:
            try:
                dia = int(input("Digite o dia de início do projeto (1-29): "))
                if dia < 1 or dia > 29:
                    print("O número do dia deve ser de 1-29. Tente novamente")
                    continue
            except ValueError:
                print("O dia só contém números. Tente novamente")
                continue

        else:
            try:
                dia = int(input("Digite o dia de início do projeto (1-28): "))
                if dia < 1 or dia > 28:
                    print("O número do dia deve ser de 1-28. Tente novamente")
                    continue
            except ValueError:
                print("O dia só contém números. Tente novamente")
                continue

        break

    while True:
        try:
            simnao = int(input("Você possui data de término do projeto? Digite 1 se tiver e 2 se não tiver: "))
            if simnao < 1 or simnao > 2:
                print("Digite 1 ou 2")
                continue
        except ValueError:
            print("Digite 1 ou 2")
            continue
        break



    if simnao == 1:
        while True:
            try:
                ano2 = int(input("Digite o ano de término do projeto: "))
                if ano2 < ano:
                    print("Você não terminou o projeto antes de iniciar. Tente novamente.")
                    continue
            except ValueError:
                print("O ano só contém números. Tente novamente")
                continue
            break

        while True:
            try:
                mes2 = int(input("Digite o mês de término do projeto (1-12): "))
                if mes2 < 1 or mes2 > 12:
                    print("O número do mês deve ser de 1-12. Tente novamente")
                    continue
                if ano2 == ano and mes2 < mes:
                    print("Você não terminou o projeto antes de iniciar. Tente novamente.")
                    continue
            except ValueError:
                print("O mês só contém números. Tente novamente")
                continue
            break

        while True:
            if mes2 in lista1:
                try:
                    dia2 = int(input("Digite o dia de término do projeto (1-31): "))
                    if dia2 < 1 or dia2 > 31:
                        print("O número do dia deve ser de 1-31. Tente novamente")
                        continue
                except ValueError:
                    print("O dia só contém números. Tente novamente")
                    continue
            elif mes2 in lista2:
                try:
                    dia2 = int(input("Digite o dia de término do projeto (1-30): "))
                    if dia2 < 1 or dia2 > 30:
                        print("O número do dia deve ser de 1-30. Tente novamente")
                        continue
                except ValueError:
                    print("O dia só contém números. Tente novamente")
                    continue
            elif mes2 == 2 and ano2 % 4 == 0:
                try:
                    dia2 = int(input("Digite o dia de término do projeto (1-29): "))
                    if dia2 < 1 or dia2 > 29:
                        print("O número do dia deve ser de 1-29. Tente novamente")
                        continue
                except ValueError:
                    print("O dia só contém números. Tente novamente")
                    continue

            else:
                try:
                    dia2 = int(input("Digite o dia de término do projeto (1-28): "))
                    if dia2 < 1 or dia2 > 28:
                        print("O número do dia deve ser de 1-28. Tente novamente")
                        continue
                except ValueError:
                    print("O dia só contém números. Tente novamente")
                    continue

            if ano2 == ano and mes2 == mes and dia2 < dia:
                print("Você não terminou o projeto antes de iniciar. Tente novamente.")
                continue

            break
        dataI = date(ano, mes, dia)
        dataI = dataI.strftime('%d-%m-%Y')
        dataT = date(ano2, mes2, dia2)
        dataT = dataT.strftime('%d-%m-%Y')
        datas = (dataI, dataT)
        return datas
    if simnao == 2:
        dataI = date(ano, mes, dia)
        dataI = dataI.strftime('%d-%m-%Y')
        return dataI

def simsair(p):
    if p.lower() == 'sim':
        return '1'
    elif p.lower() == 'sair':
        return '2'
    else:
        while (p.lower()!='sim' or p.lower()!='sair'):
            p = input("Opção inválida! Tente novamente (Sim para continuar, Sair para voltar): ")
            return simsair(p)
        

def projeto():
    
    while True:
        print('''==== Projetos ====
[1] Cadastrar Projeto
[2] Listar Projetos
[3] Buscar Projetos
[4] Atualizar Projetos
[5] Remover Projetos
[0] Voltar''') #Esse menu provavelmente será removido depois, pois o Gustavo Silvestre é responsável pela interface
        print("Digite o número da opção que deseja selecionar: ")
        x = verifyTXT()
        if (x==0):
            print("Voltando...")
            break
        
        while (x==1):
            nome = input("Escreva o nome do seu projeto (NOME ÚNICO): ").strip() #strip() serve para o nome não poder ser só "         ", porque ele tira os espaços do começo e do final (mas não tira os espaços do meio)
            if not nome:
                continue
            t = check(nome)
            while t == True:
                nome = input("Esse nome já existe. Digite outro: ")
                t = check(nome)
            data = obterdatas()
            
            projetos.update({nome.upper(): data})
            break
    
        if (x==2):
            print(projetos)
            y = input("Digite qualquer coisa para voltar ao menu: ")
            continue

        while (x==3): 
            z = input("Escreva o nome do projeto: ")
            if check(z) == True:
                print(z.upper(), ':', projetos[z.upper()])
            else:
                print('Projeto não encontrado. Deseja continuar pesquisando? Digite "Sim" para continuar pesquisando.')
                p = input('''Projeto não encontrado. Deseja continuar pesquisando? Digite "Sim" para continuar pesquisando.
Se quiser sair, digite "Sair": ''')
                p = simsair(p)
                if p == '1':
                    continue
                elif p == '2':
                    break
            y = input("Digite qualquer coisa para voltar ao menu: ")
            break
        
        while(x==4):
            a = input("Digite o nome do projeto que deseja atualizar, ou digite Sair para voltar ao menu: ")
            while(check(a) == False):
                if a.upper() == "SAIR":
                    break
                a = input("Seu projeto não foi encontrado. Tente novamente (Se quiser sair, digite Sair): ")
            if a.upper() == "SAIR":
                break
            while True:
                nome = input("Digite o novo nome do projeto: ").strip()
                if not nome:
                    continue
                t = check(nome)
                while t == True:
                    nome = input("Esse nome já existe. Digite outro: ").strip()
                    if not nome:
                        continue
                    t = check(nome)
                data = obterdatas()
                del projetos[a.upper()]
                e = {nome: data}
                break
            projetos.update(e)
            print("Projeto atualizado!")
            continue

        if x==5:
            while True:
                b = input("Escreva o Nome do projeto que deseja remover (Digite Sair para sair): ")
                if b.upper()=="SAIR":
                    break
                if (check(b) == False):
                    p = input('''Projeto não encontrado. Deseja continuar pesquisando? Digite "Sim" para continuar pesquisando.
Se quiser sair, digite "Sair": ''')
                    p = simsair(p)
                    if p == '1':
                        continue
                    elif p == '2':
                        break
                else:
                    del projetos[b.upper()]
                    print("Deletado com sucesso!")
                continue

        continue

        
        
projetos = {}
projeto()
