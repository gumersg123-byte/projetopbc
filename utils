from datetime import date, datetime
import re

def Tratamento():
    while True:
        try:
            x=int(input('Digite uma opção: '))
        except ValueError:
            print("Você não digitou um número. Tente novamente")
            continue
        break
    return x

def verifyTXT():
    while True:
        try:
            x = int(input())
            if(x<0 or x>5):
                print("O número não corresponde com as opções. Tente novamente")
                continue
        except ValueError:
            print("Você não digitou um número. Tente novamente")
            continue
        break
    return x

def formatar_id(id_int, prefixo='p'):
    return f"{prefixo}_{id_int:03d}"

def simsair(p):
    p = p.strip().lower() 
    if p == 'sim':
        return '1'
    elif p == 'sair':
        return '2'
    else:
        while p != 'sim' and p != 'sair':
            p = input("Opção inválida! Tente novamente (Sim para continuar, Sair para voltar): ").strip().lower()
        return '1' if p == 'sim' else '2'


def validar_formato_email(email):
    regex = r"^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$"
    if re.fullmatch(regex, email):
        return True
    return False

STATUS_VALIDOS = ["pendente", "andamento", "concluída"]

def validar_data(data_str: str) -> bool:
    try:
        datetime.strptime(data_str, "%Y-%m-%d")
        return True
    except Exception:
        return False

def validar_status(status: str) -> bool:
    return status.lower() in STATUS_VALIDOS


def obterdatas():
    lista1 = [1, 3, 5, 7, 8, 10, 12]
    lista2 = [4, 6, 9, 11]
    while True:
        try:
            ano = int(input("Digite o ano de início do projeto: "))
        except ValueError:
            print("O ano só contém números. Tente novamente")
            continue
        break

    while True:
        try:
            mes = int(input("Digite o mês de início do projeto (1-12): "))
            if mes < 1 or mes > 12:
                print("O número do mês deve ser de 1-12. Tente novamente")
                continue
        except ValueError:
            print("O mês só contém números. Tente novamente")
            continue
        break

    while True:
        if mes in lista1:
            try:
                dia = int(input("Digite o dia de início do projeto (1-31): "))
                if dia < 1 or dia > 31:
                    print("O número do dia deve ser de 1-31. Tente novamente")
                    continue
            except ValueError:
                print("O dia só contém números. Tente novamente")
                continue
        elif mes in lista2:
            try:
                dia = int(input("Digite o dia de início do projeto (1-30): "))
                if dia < 1 or dia > 30:
                    print("O número do dia deve ser de 1-30. Tente novamente")
                    continue
            except ValueError:
                print("O dia só contém números. Tente novamente")
                continue
        elif mes == 2 and ano % 4 == 0:
            try:
                dia = int(input("Digite o dia de início do projeto (1-29): "))
                if dia < 1 or dia > 29:
                    print("O número do dia deve ser de 1-29. Tente novamente")
                    continue
            except ValueError:
                print("O dia só contém números. Tente novamente")
                continue

        else:
            try:
                dia = int(input("Digite o dia de início do projeto (1-28): "))
                if dia < 1 or dia > 28:
                    print("O número do dia deve ser de 1-28. Tente novamente")
                    continue
            except ValueError:
                print("O dia só contém números. Tente novamente")
                continue

        break

    while True:
        try:
            simnao = int(input("Você possui data de término do projeto? Digite 1 se tiver e 2 se não tiver: "))
            if simnao < 1 or simnao > 2:
                print("Digite 1 ou 2")
                continue
        except ValueError:
            print("Digite 1 ou 2")
            continue
        break



    if simnao == 1:
        while True:
            try:
                ano2 = int(input("Digite o ano de término do projeto: "))
                if ano2 < ano:
                    print("Você não terminou o projeto antes de iniciar. Tente novamente.")
                    continue
            except ValueError:
                print("O ano só contém números. Tente novamente")
                continue
            break

        while True:
            try:
                mes2 = int(input("Digite o mês de término do projeto (1-12): "))
                if mes2 < 1 or mes2 > 12:
                    print("O número do mês deve ser de 1-12. Tente novamente")
                    continue
                if ano2 == ano and mes2 < mes:
                    print("Você não terminou o projeto antes de iniciar. Tente novamente.")
                    continue
            except ValueError:
                print("O mês só contém números. Tente novamente")
                continue
            break

        while True:
            if mes2 in lista1:
                try:
                    dia2 = int(input("Digite o dia de término do projeto (1-31): "))
                    if dia2 < 1 or dia2 > 31:
                        print("O número do dia deve ser de 1-31. Tente novamente")
                        continue
                except ValueError:
                    print("O dia só contém números. Tente novamente")
                    continue
            elif mes2 in lista2:
                try:
                    dia2 = int(input("Digite o dia de término do projeto (1-30): "))
                    if dia2 < 1 or dia2 > 30:
                        print("O número do dia deve ser de 1-30. Tente novamente")
                        continue
                except ValueError:
                    print("O dia só contém números. Tente novamente")
                    continue
            elif mes2 == 2 and ano2 % 4 == 0:
                try:
                    dia2 = int(input("Digite o dia de término do projeto (1-29): "))
                    if dia2 < 1 or dia2 > 29:
                        print("O número do dia deve ser de 1-29. Tente novamente")
                        continue
                except ValueError:
                    print("O dia só contém números. Tente novamente")
                    continue

            else:
                try:
                    dia2 = int(input("Digite o dia de término do projeto (1-28): "))
                    if dia2 < 1 or dia2 > 28:
                        print("O número do dia deve ser de 1-28. Tente novamente")
                        continue
                except ValueError:
                    print("O dia só contém números. Tente novamente")
                    continue

            if ano2 == ano and mes2 == mes and dia2 < dia:
                print("Você não terminou o projeto antes de iniciar. Tente novamente.")
                continue

            break
        dataI = date(ano, mes, dia)
        dataI = dataI.strftime('%d-%m-%Y')
        dataT = date(ano2, mes2, dia2)
        dataT = dataT.strftime('%d-%m-%Y')
        datas = (dataI, dataT)
        return datas
    if simnao == 2:
        dataI = date(ano, mes, dia)
        dataI = dataI.strftime('%d-%m-%Y')
        dataT = None
        datas = (dataI, dataT)
        return datas
